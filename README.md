# Guacamole + Caddy Deployment Script

–≠—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä—É–µ—Ç —Ä–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏–µ Apache Guacamole —Å –æ–±—Ä–∞—Ç–Ω—ã–º –ø—Ä–æ–∫—Å–∏ Caddy –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º –ø–æ–ª—É—á–µ–Ω–∏–µ–º SSL-—Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤ –æ—Ç Let's Encrypt.

## –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

- üõ°Ô∏è –î–≤—É—Ö—É—Ä–æ–≤–Ω–µ–≤–∞—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è (Basic Auth + Guacamole Login)
- üîí –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ HTTPS —Å Let's Encrypt
- üöÄ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ WebSocket –¥–ª—è –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–π –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- üíª –ì–æ—Ç–æ–≤–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ VNC-—Å–µ—Ä–≤–µ—Ä—É
- üê≥ –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ Docker Compose
- ‚öôÔ∏è –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

## –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

1. –°–µ—Ä–≤–µ—Ä —Å Linux (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è Ubuntu 22.04+)
2. –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ Docker –∏ Docker Compose
3. –î–æ–º–µ–Ω–Ω–æ–µ –∏–º—è, —É–∫–∞–∑—ã–≤–∞—é—â–µ–µ –Ω–∞ IP-–∞–¥—Ä–µ—Å —Å–µ—Ä–≤–µ—Ä–∞
4. –û—Ç–∫—Ä—ã—Ç—ã–µ –ø–æ—Ä—Ç—ã 80 –∏ 443 –≤ –±—Ä–∞–Ω–¥–º–∞—É—ç—Ä–µ
5. –î–æ—Å—Ç—É–ø–Ω—ã–π VNC-—Å–µ—Ä–≤–µ—Ä –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

1. –°–∫–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –∏–ª–∏ —Å–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `deploy-guacamole.sh` —Å —Å–æ–¥–µ—Ä–∂–∏–º—ã–º —Å–∫—Ä–∏–ø—Ç–∞
2. –î–∞–π—Ç–µ –ø—Ä–∞–≤–∞ –Ω–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ:
   ```bash
   chmod +x deploy-guacamole.sh
   ```
3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç:
   ```bash
   ./deploy-guacamole.sh
   ```
4. –°–ª–µ–¥—É–π—Ç–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º –Ω–∞ —ç–∫—Ä–∞–Ω–µ

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

–í–æ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Å–∫—Ä–∏–ø—Ç –∑–∞–ø—Ä–æ—Å–∏—Ç:

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –û–ø–∏—Å–∞–Ω–∏–µ | –ü—Ä–∏–º–µ—Ä –∑–Ω–∞—á–µ–Ω–∏—è |
|----------|----------|-----------------|
| –î–æ–º–µ–Ω | –í–∞—à–µ –¥–æ–º–µ–Ω–Ω–æ–µ –∏–º—è | `guac.example.com` |
| Email –¥–ª—è Let's Encrypt | Email –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –æ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞—Ö | `admin@example.com` |
| VNC-—Ö–æ—Å—Ç | IP –∏–ª–∏ –∏–º—è —Ö–æ—Å—Ç–∞ VNC-—Å–µ—Ä–≤–µ—Ä–∞ | `192.168.1.100` |
| VNC-–ø–æ—Ä—Ç | –ü–æ—Ä—Ç VNC-—Å–µ—Ä–≤–µ—Ä–∞ | `5900` |
| –ü–∞—Ä–æ–ª—å VNC-—Å–µ—Ä–≤–µ—Ä–∞ | –ü–∞—Ä–æ–ª—å –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ VNC | `secret-vnc-pass` |
| –í–µ–±-–ª–æ–≥–∏–Ω | –õ–æ–≥–∏–Ω –¥–ª—è Basic Auth | `admin` |
| –í–µ–±-–ø–∞—Ä–æ–ª—å | –ü–∞—Ä–æ–ª—å –¥–ª—è Basic Auth | `strong-password` |
| –õ–æ–≥–∏–Ω Guacamole | –õ–æ–≥–∏–Ω –¥–ª—è –≤—Ö–æ–¥–∞ –≤ Guacamole | `guac-user` |
| –ü–∞—Ä–æ–ª—å Guacamole | –ü–∞—Ä–æ–ª—å –¥–ª—è –≤—Ö–æ–¥–∞ –≤ Guacamole | `guac-pass` |

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

–ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Å–∫—Ä–∏–ø—Ç–∞ —Å–æ–∑–¥–∞–µ—Ç—Å—è —Å–ª–µ–¥—É—é—â–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤:

```
guacamole_deploy/
‚îú‚îÄ‚îÄ docker-compose.yml       # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Docker-—Å–µ—Ä–≤–∏—Å–æ–≤
‚îú‚îÄ‚îÄ Caddyfile                # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –æ–±—Ä–∞—Ç–Ω–æ–≥–æ –ø—Ä–æ–∫—Å–∏
‚îî‚îÄ‚îÄ guacamole/
    ‚îú‚îÄ‚îÄ guacamole.properties # –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ñ–∏–≥ Guacamole
    ‚îî‚îÄ‚îÄ user-mapping.xml     # –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
```

## –î–æ—Å—Ç—É–ø –∫ Guacamole

–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ —Ä–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏—è:
1. –û—Ç–∫—Ä–æ–π—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ: `https://–≤–∞—à-–¥–æ–º–µ–Ω`
2. –í–≤–µ–¥–∏—Ç–µ –ª–æ–≥–∏–Ω/–ø–∞—Ä–æ–ª—å Basic Auth
3. –í–≤–µ–¥–∏—Ç–µ –ª–æ–≥–∏–Ω/–ø–∞—Ä–æ–ª—å Guacamole
4. –í—ã–±–µ—Ä–∏—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ "VNC Connection"

## –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–∞–º–∏

```bash
# –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–∏—Å–æ–≤
docker-compose up -d

# –û—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–µ—Ä–≤–∏—Å–æ–≤
docker-compose down

# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
docker-compose logs -f

# –ü–µ—Ä–µ—Å–æ–∑–¥–∞–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–æ–≤
docker-compose up -d --force-recreate
```

## –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–∞–¥–æ–∫

### –û—à–∏–±–∫–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ VNC
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å VNC-—Å–µ—Ä–≤–µ—Ä–∞:
   ```bash
   telnet VNC_–•–û–°–¢ VNC_–ü–û–†–¢
   ```
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ VNC-—Å–µ—Ä–≤–µ—Ä –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å –ø–∞—Ä–æ–ª—è VNC

### –ü—É—Å—Ç–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –ø–æ—Å–ª–µ –≤—Ö–æ–¥–∞
1. –ü–æ–¥–æ–∂–¥–∏—Ç–µ 1-2 –º–∏–Ω—É—Ç—ã –¥–ª—è –ø–æ–ª–Ω–æ–π –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ Guacamole
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏:
   ```bash
   docker-compose logs -f guacamole
   ```
3. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤ –±—Ä–∞—É–∑–µ—Ä–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∞ –∑–∞–≥—Ä—É–∑–∫–∞ "–Ω–µ–±–µ–∑–æ–ø–∞—Å–Ω—ã—Ö —Å–∫—Ä–∏–ø—Ç–æ–≤"

### –û—à–∏–±–∫–∏ WebSocket
1. –û–±–Ω–æ–≤–∏—Ç–µ Caddyfile —Å–æ–≥–ª–∞—Å–Ω–æ –ø–æ—Å–ª–µ–¥–Ω–µ–π –≤–µ—Ä—Å–∏–∏ —Å–∫—Ä–∏–ø—Ç–∞
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–æ–∫—Å–∏—Ä–æ–≤–∞–Ω–∏—è WebSocket

### –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤
–°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏. –í—Ä—É—á–Ω—É—é –º–æ–∂–Ω–æ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å Caddy:
```bash
docker-compose restart caddy
```

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- üîë –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–ª–æ–∂–Ω—ã–µ –ø–∞—Ä–æ–ª–∏ –¥–ª—è –≤—Å–µ—Ö —É—Ä–æ–≤–Ω–µ–π –¥–æ—Å—Ç—É–ø–∞
- üîÑ –†–µ–≥—É–ª—è—Ä–Ω–æ –æ–±–Ω–æ–≤–ª—è–π—Ç–µ Docker-–æ–±—Ä–∞–∑—ã
- üîí –û–≥—Ä–∞–Ω–∏—á—å—Ç–µ –¥–æ—Å—Ç—É–ø –∫ VNC-—Å–µ—Ä–≤–µ—Ä—É —Ç–æ–ª—å–∫–æ —Å Guacamole-—Ö–æ—Å—Ç–∞
- ‚è±Ô∏è –ù–∞—Å—Ç—Ä–æ–π—Ç–µ —Ä–µ–≥—É–ª—è—Ä–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–∞—Ä–æ–ª–µ–π

## –õ–∏—Ü–µ–Ω–∑–∏—è

–≠—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—è–µ—Ç—Å—è –ø–æ–¥ –ª–∏—Ü–µ–Ω–∑–∏–µ–π MIT. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –Ω–∞ —Å–≤–æ–π —Å—Ç—Ä–∞—Ö –∏ —Ä–∏—Å–∫.
